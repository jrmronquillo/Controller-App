<!DOCTYPE html>
<html>
<head>
	<title>Sample App</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<style>
		.contain-full {
			position: fixed;
			top:0px;
			left:0px;
			background-color: rgba(0,0,0,0.3);
			/*opacity: 0.5;*/
			width: 100% !important;
			height: 100%;
			text-align: center;
			padding: 50px;
		}
		.header{
			vertical-align: top;
		}
		.main-title, #key-down, .main {
			margin-top: 150px;
			color:white;
			font-size:25px;
		}
		#button1{
			justify-content: right;
			background-color: red;
			width: 100px;
			height: 50px;
			border-radius: 10px;
			color: white;
			margin-right: 0px;
		}
		.footer{
			align-content: flex-end;
		}
		.controller-main-bg{
		  position: fixed;
		  display: block;
		  height: 100%;
		  background-color: #cccccc;
		  filter: blur(5px);
		  -webkit-filter: blur(5px);
		  background-repeat: no-repeat;
		  background-position: center;
		  background-size: cover;
		  left: 0;
		  right:0;
		  z-index: -1;
		}

		.nav-bar-text, h2{
			color: white;
		}

		.tiles{
			display:flex;
  			min-width: 100%;
  			min-height: 200px;
  			flex-wrap: nowrap;
  			overflow-x: scroll;
		}
		
		.tile{
			background-color: #CBCBCB;
  			min-width: 120px;
  			min-height: 200px;
  			margin: 10px;
  			/*overflow-x: auto;*/
			}

		.tile:hover{
			background-color: #CBCBCB;
  			min-width: 120px;
  			min-height: 200px;
  			margin: 10px;
  			border-style: solid;
		}

		.tile:focus{
			background-color: #CBCBCB;
  			min-width: 120px;
  			min-height: 200px;
  			margin: 10px;
  			border-style: solid;
		}

		
	</style>
	<script type="text/javascript">

		//If we are a stb, set the resolution
		if (!!navigator.setResolution) {
		  navigator.setResolution(1920, 1080);
		}

	 


	    function moveRight(){
	    		alert('move right 1');
	    }

	  
	    var xpos = 0;
	    var ypos = 0;
		function keyHandler(e){
			var code = e.keyCode
				, container = document.getElementById('key-down');

			//Don't for get to put a BREAK after every case OR it will
			//Fall through like it does below.
			switch(code){
        case 13: // Select / Enter
        case 32: //spacebar
        		window.location.href = "/sampleApp2/page1/";
        		break;
       	case 37: //left key
       			xpos--;
       			console.log('x:'+xpos);
       			console.log('y:'+ypos);
       			if (xpos<1){
       				xpos=document.getElementsByClassName('tile').length+1;
       			}
       			if (ypos==0){
       				makeUnderline('nav'+String(xpos));
       			} else {
       				makeFocus('tile'+String(xpos));
       			}
       			break;
       	case 38: //up key
       		ypos--;
       		xpos=1;
       		console.log('x:'+xpos);
       		console.log('y:'+ypos);
   			if (ypos<0){
   				ypos=1;
   			}
   			console.log('yposAFter:'+String(ypos));

   			if(ypos == 0){
       				makeUnderline('nav'+String(xpos));
       			} else {
       				makeFocus('tile'+String(xpos));
       			}
   			//makeUnderline('nav1');
   			break;
       		
       	case 39: //right key
       			xpos++;
       			console.log('x:'+xpos);
       			console.log('y:'+ypos);
       			//if (xpos>document.getElementsByClassName('tile').length){
       			//	xpos=1;
       			//}
       			if (ypos==0){
       				if (xpos>document.getElementsByClassName('nav-bar-text').length+1){
       					xpos=1;	
       				}
       				makeUnderline('nav'+String(xpos));	
       			} else {
       				console.log('???');
       				if(xpos>document.getElementsByClassName('tile').length+1){
       					xpos=1;
       					ypos=1;
       				}       				
       				makeFocus('tile'+String(xpos));
       			}
       			console.log('xposAFter:'+String(xpos));
       			console.log('yposAfter:'+String(ypos));
       			break;
       	case 40: //down key
       			
       			xpos=1;
       			ypos++;
       			console.log('x:'+xpos);
       			console.log('y:'+ypos);
       			console.log('yposAFter:'+ypos);
       			if (ypos>1){
       				// if y position is greater than 1, set back to 0
       				ypos=0;
       			}
       			if(ypos == 1){
       				makeFocus('tile'+String(xpos));
       			} else {
       				makeUnderline('nav'+String(xpos));
       			}
       			break;
        case 48 : // 0
        case 49 : // 1
        case 50 : // 2
        case 51 : // 3
        case 52 : // 4
        case 53 : // 5
        case 54 : // 6
        case 55 : // 7
        case 56 : // 8
        case 57 : // 9
        case 79 : // Info
        case 87 : // Rewind Trick play
        case 9 : // FF Trick play
        case 65 : //Active
        case 67 : // Next Trick play
        case 72 : // red
        case 74 : // green
        case 75 : // yellow
        case 76 : // blue
        case 80: // Play Trick play
        case 82 : // Record Trick play
        case 83 : // Stop Trick play
        case 85 : // Pause Trick play
        case 46 : // Back Trick play
        case 37: //left
        case 33: //pageup channelUp
        case 34: //pagedown channelDown
        case 38: //up
        case 39: //right
        case 40: //down
        case 47: //back
        case 189 : //dash
        default :
        	container.innerHTML = code;
        	break;
      }

			// return false prevents keys from bubbling to UI
			return false;
	  }

		window.onkeydown = keyHandler;

		window.onerror = function(errorMsg, url, lineNumber){
		   // If Webkit throws an error on the STB - the app crashes.
		   // To prevent the propagation and therefore the crash
		   // return true

		   // Look for this console.log message in the logs
		   // To access the logs use http://{STB_IP}/itv/getLogs
		   console.log(errorMsg);
		   return true;
		 };

		 document.getElementById('myiframe').contentWindow.onerror = function(){
		 	// perform error reporting or take corrective action
		 	return false;
		 };

		 function exiter(){
		 	navigator.exit();
		 }

		 window.onload = function(){
		 	document.getElementById('tile1').focus();
		 };

		 function makeUnderline(navItemId){
		 	// clear any tile highlights to avoid double highlights
		 	for(var x=1; x < document.getElementsByClassName('tile').length; x++){
		 		document.getElementById('tile'+String(x)).style.border = "none";
		 	}

		 	for(var i=1; i <= document.getElementsByClassName('nav-bar-text').length; i++){
		 		//alert('nav'+String(i));
		 		if(navItemId == 'nav'+String(i)){
		 			document.getElementById(navItemId).style.textDecoration = "underline overline red";
		 		} else {
		 			document.getElementById('nav'+String(i)).style.textDecoration = "none";
		 		}
		 	}
		 }

		 function makeFocus(tileId){
		 	//clear any nav-bar-text highlights to avoid double highlights
		 	for(var x=1; x <= document.getElementsByClassName('nav-bar-text').length; x++){
		 		document.getElementById('nav'+String(x)).style.textDecoration = "none";
		 	}


		 	for(var i=1; i < document.getElementsByClassName('tile').length+1; i++){
		 		//alert('test'+String(i));
		 		if(tileId == 'tile'+String(i)){
		 			document.getElementById(tileId).style.border = "thick solid #0000FF";
		 		} else {
		 			document.getElementById('tile'+String(i)).style.border = "none";
		 		}
		 		//document.getElementById('tile'+String(i)).style.border = "dashed";
		 	}	
		 }


		


		 

</script>
</head>
<body onload="">
	<div class="controller-main-bg"></div>
	<div class="contain-full">
		<div class="header">
			<div class = 'row'>
				<div class='col-sm-4'>
					<img src="https://placeimg.com/300/100/any" class='img-responsive'>
				</div>
				<div class='col-sm-2 nav-bar-text align-text-bottom' id ="nav1" onclick="makeUnderline('nav1')">
					For You
				</div>
				<div class='col-sm-2 nav-bar-text text-center' id ="nav2" onclick="makeUnderline('nav2')">
					Search
				</div>
				<div class='col-sm-2 nav-bar-text text-center' id ="nav3" onclick="makeUnderline('nav3')">
					Settings
				</div>
			</div>
			<hr>
			<button onclick="highlight();">Navi-test</button>
			<div id="key-down"></div>
			<div class = "row">
				<div class="col-xs-4 text-align-left">
					<h2>Live Stations</h2>
				</div>
			</div>
			<div class="row tiles">
				<div class = "row flex-row flex-nowrap tiles">
					<a href="#"><div class = 'tile' id='tile1' onclick="makeFocus('tile1')" ></div></a>
					<a href="#"><div class = 'tile' id='tile2' onclick="makeFocus('tile2')" ></div></a>
					<div class = 'tile' id='tile3' tabindex='0' onclick="makeFocus('tile3');"></div>
					<div class = 'tile' id='tile4' onclick="makeFocus('tile4');"></div>
					<div class = 'tile' id='tile5' onclick="makeFocus('tile5');"></div>
					<div class = 'tile' id='tile6' onclick="makeFocus('tile6');"></div>
					<div class = 'tile' id='tile7' onclick="makeFocus('tile7');"></div>
					<div class = 'tile' id='tile8' onclick="makeFocus('tile8');"></div>
					<div class = 'tile' id='tile9' onclick="makeFocus('tile9');"></div>
					<div class = 'tile' id='tile10' onclick="makeFocus('tile10');"></div>
					<div class = 'tile' id='tile11' onclick="makeFocus('tile11');"></div>	
					<div class = 'tile' id='tile12' onclick="makeFocus('tile12');"></div>
					<div class = 'tile' id='tile13' onclick="makeFocus('tile13');"></div>
					<div class = 'tile' id='tile14' onclick="makeFocus('tile14');"></div>
					<div class = 'tile' id='tile15' onclick="makeFocus('tile15');"></div>	
					<div class = 'tile' id='tile16' onclick="makeFocus('tile16');"></div>
					<div class = 'tile' id='tile17' onclick="makeFocus('tile17');"></div>		
				</div>
			</div>
		</div>		
	</div>
	<script type="text/javascript" src="app.js"></script>
</body>
</html>
